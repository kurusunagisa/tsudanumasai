{"mappings":"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","sources":["src/sketch.js"],"sourcesContent":["const  {Player, SongleTimer} = TextAliveApp;\r\n\r\nconst songleTimer = new SongleTimer({accessToken:\"00000101-b8RiuAV\",\r\nsecretToken:\"HQtMEczdpbvXSfgY7n3ht5G2T76AT9QR\"})\r\n\r\nconst player = new Player({\r\n    app: {token: \"dR17qZsRe0YR9VYq\",\r\n        parameters: [\r\n        ],\r\n    },\r\n    mediaElement: document.querySelector(\"#media\"),\r\n    mediaBannerPosition: \"bottom right\",\r\n    timer: songleTimer\r\n});\r\n\r\nwindow.addEventListener('beforeunload', (event) => {\r\n    event.preventDefault();\r\n    player.requestPause() && player.requestStop() && player.requestMediaSeek(0) && player.dispose();\r\n    return \"\";\r\n});\r\n\r\nconst play = document.querySelector(\"#play\");\r\nconst jump = document.querySelector(\"#jump\");\r\nconst pause = document.querySelector(\"#pause\");\r\nconst rewind = document.querySelector(\"#rewind\");\r\n\r\nconst positionEl = document.querySelector(\"#position strong\");\r\nconst phraseEl = document.querySelector(\"#phrase\");\r\n\r\nconst artist = document.querySelector(\"#artist span\");\r\nconst song = document.querySelector(\"#song span\");\r\n\r\n\r\nplayer.addListener({\r\n    onAppReady,\r\n    onTimerReady,\r\n    onTimeUpdate,\r\n    onThrottledTimeUpdate,\r\n    onTextLoad,\r\n    //onPlay,\r\n})\r\n\r\nfunction onAppReady(app){\r\n    if (!app.managed){\r\n        document.querySelector(\"#control\").style.display = \"block\";\r\n        play.addEventListener(\"click\", () => player.video && player.requestPlay());\r\n        jump.addEventListener(\"click\", () => player.video && player.requestMediaSeek(player.video.firstPhrase.startTime));\r\n        pause.addEventListener(\"click\", () => player.video && player.requestPause());\r\n        rewind.addEventListener(\"click\", () => player.video && player.requestMediaSeek(0));\r\n    }\r\n    if (!app.songUrl) {\r\n        // blues / First Note\r\n        player.createFromSongUrl(\"https://piapro.jp/t/FDb1/20210213190029\", {\r\n            video: {\r\n            // 音楽地図訂正履歴: https://songle.jp/songs/2121525/history\r\n            beatId: 3953882,\r\n            repetitiveSegmentId: 2099561,\r\n            // 歌詞タイミング訂正履歴: https://textalive.jp/lyrics/piapro.jp%2Ft%2FFDb1%2F20210213190029\r\n            lyricId: 52065,\r\n            lyricDiffId: 5093,\r\n            },\r\n        });\r\n    }\r\n}\r\n\r\n//楽曲の開始可能時によびだされる\r\nfunction onTimerReady(){\r\n    /*if (window.name != \"video\"){\r\n        window.name=\"video\";\r\n        location.reload();\r\n    }else{\r\n        window.name=\"\";\r\n    }*/\r\n    player.requestPause();\r\n    artist.textContent = player.data.song.artist.name;\r\n    song.textContent = player.data.song.name;\r\n    document.querySelectorAll(\"button\").forEach((btn) => (btn.disabled = false));\r\n    let p = player.video.firstPhrase;\r\n    jump.disabled = !p;\r\n    while (p && p.next) {\r\n        p.animate = animatePhrase;\r\n        p = p.next;\r\n    }\r\n}\r\n\r\n//拍の取得\r\nfunction onTimeUpdate(position){\r\n    const beat = player.findBeat(position);\r\n    if (!beat){\r\n        return;\r\n    }\r\n}\r\n\r\nfunction onTextLoad(body){\r\n    document.querySelector(\"#dummy\").textContent = body?.text;\r\n}\r\n\r\nfunction onThrottledTimeUpdate(pos){\r\n    positionEl.textContent = String(Math.floor(pos));\r\n}\r\n\r\nfunction animatePhrase(now, unit){\r\n    if (unit.contains(now)){\r\n        phraseEl.textContent = unit.text;\r\n    }\r\n}\r\n\r\nconst width = window.innerWidth;\r\nconst height = window.innerHeight;\r\nconst margin = 30;\r\nconst numChars = 10;\r\nconst textAreaWidth = width - margin * 2;\r\n\r\n    function setup(){\r\n    console.log(\"test\");\r\n    createCanvas(width,height);\r\n    colorMode(p5.HSB, 100);\r\n    frameRate(30);\r\n    background(20);\r\n    noStroke();\r\n    textFont(\"Noto Sans JP\");\r\n    //文字の位置\r\n    textAlign(p5.CENTER,p5.CENTER);\r\n    circle(10,10,10);\r\n    }\r\n\r\n    function draw(){\r\n        if (!player || !player.video){\r\n            return;\r\n        }\r\n        //circle(10,10,10)\r\n        //camera.on();\r\n        camera.x += 1;\r\n        //フレーズを取得\r\n\r\n        //もしサビなら中心に移動\r\n        //中心に１文字ずつ表示\r\n\r\n        //サビが終わっていたら各ノードに戻る\r\n\r\n        //外周ノードに文字を追加\r\n\r\n        //フレーズの文字数から円の半径を計算\r\n        //3週目からは外のノードにする\r\n        //回転数が2、回転回数が4で割り切れたら中心を軸に-45度回転\r\n        //中心を軸に90度回転\r\n    }"],"names":[],"version":3,"file":"index.90c8281a.js.map","sourceRoot":"/__parcel_source_root/"}